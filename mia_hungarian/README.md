# mia_Hungarian.py：ハンガリアン法によるメンバーシップ推論攻撃（MIA）

## 概要
`mia_Hungarian.py`は、2つの同一ヘッダー付きCSV（Ai.csvとCi.csv）を入力とし、ハンガリアン法（割当問題の最適解法）を用いて、Ciの各行とAiの各行の最適な対応付けを求めることで、メンバーシップ推論攻撃を行うスクリプトです。
この手法は、匿名化やサンプリング後のデータに対しても、元データとの対応関係を推定することを目的としています。

## 入力
- `Ai.csv`：元データ（例：10万行）
- `Ci.csv`：Ai.csvからサンプリング・匿名化されたデータ（例：1万行）

## 出力
- `-o Fij.csv`で指定（デフォルトは`Fij.csv`）。1列、ヘッダー無し、各値は0/1。
  - 1：対応付けられたAiの行
  - 0：それ以外

## 使い方
```sh
python3 mia_Hungarian.py Ai.csv Ci.csv
```
- オプションで出力ファイル名を`-o`で指定可能

## アルゴリズムの流れ
1. **前処理・特徴量化**  
   - 列タイプ推定：95%以上が数値化可能なら数値列、それ以外はカテゴリ列
   - 数値列：min-maxスケーリング（[0,1]に正規化）、ゼロ分散列は除外
   - カテゴリ列：AiとCiを結合してOneHotエンコーディング、元のAi/Ciに分割
   - 特徴行列の結合：スケーリング済み数値特徴＋OneHotカテゴリ特徴を連結し、NumPy行列化

2. **コスト行列の作成**  
   - 特徴量空間上でのマンハッタン距離（L1ノルム）を用いて、Ci各行とAi各行の距離行列を作成

3. **ハンガリアン法による最適割当**  
   - `scipy.optimize.linear_sum_assignment`等を用いて、コスト（距離）の総和が最小となるようにCiとAiの行を一対一で対応付け

4. **結果の出力**  
   - 割り当てられたAiの行インデックスを1、それ以外を0としたベクトルを出力

## 注意事項
- 数値・カテゴリ混在データに対応
- 全列が除外された場合は全て0を出力
- 大規模データの場合、計算コストが高くなるため注意

## 依存ライブラリ
- numpy
- pandas
- scipy
- scikit-learn
